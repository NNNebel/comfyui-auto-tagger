# ComfyUI Auto Tagger for Eagle

[English Readme is WIP]

Eagleアプリケーション用のプラグインです。ComfyUIで生成した画像に含まれるメタデータ（Workflow JSON）を読み取り、モデル名、LoRA名、プロンプトなどを自動でEagleのタグとして付与します。

## 主な機能

- **自動タグ付け**: 画像のメタデータを解析し、以下の情報をタグとして自動で付与します。
  - Checkpoint名
  - LoRA名
  - ポジティブプロンプト（単語ごとに分割）
  - ネガティブプロンプト（単語ごとに分割）
- **柔軟な設定**:
  - プラグインのウィンドウ上で、どの情報をタグとして付与するかをチェックボックスで選択できます。
  - ネガティブプロンプトには、識別用のプレフィックス `neg:` が自動で付きます。
  - プロンプトの重み付け構文 `(word:1.2)` などもそのままタグとして保持します。
  - 一度に処理するアイテム数を調整でき、大量の画像でも安定して動作します。
- **プラグインタグのクリーンアップ**:
  - このプラグインが付与したであろうタグだけを選択的に削除する機能。手動で付けたタグは保護されます。
- **多言語対応**:
  - Eagle本体の言語設定に合わせ、UIが日本語と英語に自動で切り替わります。
- **安定性とパフォーマンス**:
  - 大量の画像を一度に処理してもUIがフリーズしないよう、チャンク処理と非同期I/Oを導入しています。
  - 処理の中止機能も搭載しています。

## インストール方法

1.  **リリースページにアクセス**: GitHubリポジトリの [Releases](https://github.com/NNNebel/comfyui-auto-tagger/releases) ページにアクセスします。
2.  **プラグインのダウンロード**: 最新バージョンの `.eagleplugin` ファイル（例: `comfyui-auto-tagger.v1.2.0.eagleplugin`）をダウンロードします。
3.  **Eagleにインストール**: ダウンロードした `.eagleplugin` ファイルを、起動中のEagleアプリケーションのウィンドウにドラッグ＆ドロップします。
4.  **インストール完了**: 「インストールが完了しました」というメッセージが表示されたら完了です。

**注意:** このプラグインは必要なライブラリを同梱しているため、ユーザー側で `npm install` などのコマンドを実行する必要はありません。

## 使い方

1.  Eagleで、タグを付けたい画像（ComfyUIで生成したWebP, PNGなど）を1つまたは複数選択します。
2.  選択した画像を右クリックし、コンテキストメニューから「ComfyUIタグ生成 (Auto Tagger)」を選択します。
3.  専用のウィンドウが開きます。
4.  ウィンドウ上のオプション（Checkpoint, LoRA, プロンプトなど）で、タグとして追加したい情報の種類にチェックを入れます。
5.  「タグ付け開始」ボタンを押すと、処理が開始されます。

## ライセンス

このプロジェクトはMITライセンスのもとで公開されることを想定しています。
（注: ライセンスファイルはまだリポジトリに追加されていません。）
