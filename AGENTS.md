# Project Status: comfyui-auto-tagger

## 概要
- **プロジェクト名:** comfyui-auto-tagger
- **目的:** Eagleのウィンドウ型プラグイン。ComfyUIで生成された画像のメタデータを読み取り、タグを自動付与する。
- **配布形式:** `node_modules` を同梱した `.eagleplugin` パッケージ。

## 現在の主要機能
- **タグ抽出:** ExifからCheckpoint, LoRA, ポジティブ/ネガティブプロンプトを抽出してタグとして追加。
- **選択的タグ付け:**
    - UIのチェックボックスで、Checkpoint, LoRA, ポジティブプロンプト, ネガティブプロンプトのON/OFFが可能。
    - デフォルトはポジティブ、Checkpoint, LoRAがON。
- **タグのフォーマット:**
    - プロンプトの重み付け構文 `(word:1.2)` はそのままタグとして保持。
    - ネガティブプロンプトには `neg:` プレフィックスを付与。
    - タグの順序は元のプロンプトの順序を維持する。
- **UIと操作性:**
    - ライトテーマとダークテーマに両対応した、視認性の高いUI。
    - 長時間処理の安定化：タグ付け・タグ削除の両方がチャンク（分割）処理になっており、UIがフリーズしない。
    - チャンクサイズ（一度に処理する数）をUIから設定可能。
    - 処理の中止ボタンを実装済み。
- **デバッグ機能:**
    - 選択したアイテムの全タグを削除する機能。

## 高速化対応
- ファイル読み込みを非同期化 (`fs.promises.readFile`)。
- タグの重複チェックを `Set` を用いて効率化。

## Gitの状態
- **`main` ブランチ:** 初版（高速化対応前）がコミット済み。
- **`feature/performance-boost` ブランチ:** **現在このブランチで作業中。** 高速化対応（非同期I/O、重複チェック効率化）のコード修正が完了しているが、**まだコミットされていない。**

## 次回再開時のタスク
1. **コミット:** 現在の `feature/performance-boost` ブランチの変更（高速化対応）をコミットする。
   - `git add .`
   - `git commit -m "feat: Apply performance improvements"`
2. **マージ:** `main`ブランチにマージする。
   - `git checkout main`
   - `git merge feature/performance-boost`
3. **ユーザーの次の指示を待つ。**
